<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Behavioural Analysis and Regression Toolkit</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">BART</h1>
      <h2 class="project-tagline">Behavioural Analysis and Regression Toolkit</h2>
      <a href="https://github.com/ARM-software/bart" class="btn">View on GitHub</a>
      <a href="https://github.com/ARM-software/bart/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/ARM-software/bart/tarball/master" class="btn">Download .tar.gz</a>
      <a href="https://pythonhosted.org/bart-py/" class="btn">API Reference</a>
    </section>

    <section class="main-content">
      <h1>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is Behavioural Analysis?</h1>

<p>
Behavioural analysis of a given system requires building an understanding of the overall system state relative to the state of specific heuristics of interest.
With such an understanding, a technique to automatically detect expected state changes in response to varying input parameters is very valuable. This is especially true when there are a large
number of factors that can change the behaviour of the system and testing all possible permutations of these factors is hard. Presented here is a toolkit that provides an assertion 
based mechanism to help evaluate system performance and correct operation.
</p>

<p>The Behavioural Analysis and Regression Toolkit is based on <a href="https://arm-software.github.io/trappy">TRAPpy</a>. The toolkit is targeted at the Linux kernel and it's primary goal is 
to help assert behaviours of interest using the FTrace output from the Linux kernel</p>

<h1>
<a id="target-audience" class="anchor" href="#target-audience" aria-hidden="true"><span class="octicon octicon-link"></span></a>Target Audience</h1>

<p>The framework caters to a wide range of users spanning developers interested in deep observation of system behaviours as well as test engineers interested in automating
the testing of "difficult to test" system behaviours.</p>
<ul><a id="kernel-developers" class="anchor" href="#kernel-developers" aria-hidden="true"><span class="octicon octicon-link"></span></a><b>Kernel Developers:</b>
Making sure that the code that you are writing is doing the right thing.
</ul>
<ul>
<a id="performance-engineers" class="anchor" href="#performance-engineers" aria-hidden="true"><span class="octicon octicon-link"></span></a><b>Performance Engineers:</b> Plotting/Asserting performance behaviours between different revisions of the kernel.
</ul>
<ul>
<a id="quality-assurancerelease-engineers" class="anchor" href="#quality-assurancerelease-engineers" aria-hidden="true"><span class="octicon octicon-link"></span></a><b>Quality Assurance/Release Engineers: </b> Verifying behaviours when different components/patches are integrated.
</ul>





<h1>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>Clone the <a href="https://github.com/ARM-software/bart">BART</a> and <a href="https://github.com/ARM-software/trappy">TRAPpy</a> repos</p>

<pre><code>git clone git@github.com:ARM-software/bart.git
git clone git@github.com:ARM-software/trappy.git
</code></pre>

<p>Add the directories to your PYTHONPATH</p>

<pre><code>export PYTHONPATH=$BASE_DIR/bart:$BASE_DIR/trappy:$PYTHONPATH
</code></pre>

<p>Install dependencies</p>

<pre><code>apt install ipython-notebook python-pandas
</code></pre>

<p><a href="http://ipython.org/notebook.html">IPython</a> notebook is a web based interactive python programming interface.
It is required if you plan to use interactive plotting in BART.</p>

<h1>
<a id="trace-analysis-language" class="anchor" href="#trace-analysis-language" aria-hidden="true"><span class="octicon octicon-link"></span></a>Trace Analysis Language</h1>


<p>BART also provides a generic Trace Analysis Language, which allows the user to construct complex relation statements on Linux kernel trace data and assert their expected behaviours. As an example, the usage of this language's Analyzer module can be seen for evaluating thermal behaviours with the Linux kernel's thermal management framework<a href="https://github.com/ARM-software/bart/blob/master/notebooks/thermal/Thermal.ipynb">here</a></p>

<h1>
<a id="specialized-modules" class="anchor" href="#specialized-modules" aria-hidden="true"><span class="octicon octicon-link"></span></a>Specialized Modules</h1>
Apart from the generic Trace Analysis Language, BART provides certain subsystem specific assertion rules. The goal is to increase the specialization across other subsystems within the Linux kernel.

<h2>
<a id="thermal-assertions" class="anchor" href="#thermal-assertions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Thermal Assertions</h2>
<p>
This module provides assertions specific to the thermal subsystem and the goal is to assert the temperature control achieved and use these assertions for potential regressions in temperature control. One interesting assertion is, <code>assertThermalResidency</code> which accepts a temperature range and checks if the time spent in the given temperature is between expected limits.
</p>
<pre><code>assertThermalResidency(between_threshold,     # A boolean function that compares the
   					      # result with the expected value

		       expected_value,	      # Expected value of residency
					      # in temperature range

		       (low_temp, high_temp)  # Temperature range
)</code></pre>


<h2>
<a id="scheduler-assertions" class="anchor" href="#scheduler-assertions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Scheduler Assertions</h2>

<p>
The Linux scheduler is complicated and susceptible to regressions over kernel revisions. Fixing or adding one area of the scheduler could have unknown and subtle repercussions
in a different heuristic. We have added a scheduler specific module which allows developers to assert points of interest and then calculate various parameters like the
duty cycle, period, execution time, residency of tasks over a CPU or a cluster for a test workload. It also features an assertion API to check if a task context switched
between two CPUs/Clusters in a given window of time. Here is a short example.
</p>
<p>Consider a task, <code>cpuhog</code>, which has alternate phases of high and low duty cycles:</p>

<style>

.d3-tip {

  line-height: 1;
  padding: 12px;
  background: rgba(0, 0, 0, 0.6);
  color: #fff;
  border-radius: 2px;
  position: absolute !important;
  z-index: 99999;

}

.d3-tip:after {

  box-sizing: border-box;
  pointer-events: none;
  display: inline;
  font-size: 10px;
  width: 100%;
  line-height: 1;
  color: rgba(0, 0, 0, 0.6);
  content: "\25BC";
  position: absolute !important;
  z-index: 99999;
  text-align: center;

}

.d3-tip.n:after {

  margin: -1px 0 0 0;
  top: 100%;
  left: 0;

}

.chart {

  shape-rendering: crispEdges;

}

.mini text {

  font: 9px sans-serif;

}

.main text {

  font: 12px sans-serif;

}

.axis line, .axis path {

  stroke: black;

}

.miniItem {

  stroke-width: 8;

}

.brush .extent {

  stroke: #000;
  fill-opacity: .125;
  shape-rendering: crispEdges;

}

</style>

<div id="fig_421afa8cc8234df49030c900b680220b" class="eventplot">
        <script>
            var req = require.config( {

                paths: {

                    "EventPlot": "https://rawgit.com/sinkap/7f89de3e558856b81f10/raw/46144f8f8c5da670c54f826f0c634762107afc66/EventPlot",
                    "d3-tip": "http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3",
                    "d3": "http://d3js.org/d3.v3.min"
                },
                shim: {
                    "d3-tip": ["d3"],
                    "EventPlot": {

                        "deps": ["d3-tip", "d3" ],
                        "exports":  "EventPlot"
                    }
                }
            });
            req(["require", "EventPlot"], function() {
               EventPlot.generate('fig_421afa8cc8234df49030c900b680220b', 'https://rawgit.com/sinkap/a207675f6483aa0b9342/raw/825717935112f36fe996b77093c0c71d3871fee4/fig_421afa8cc8234df49030c900b680220b.json');
            });
        </script>
</div>

<p style="font-size: 12px">Scroll on the Plot area to Zoom. Click and Drag to Pan Zoom.</p>

<p>
We have a dual cluster asymmetric hardware. The topology can be expressed as:

</p>
<pre><code>BIG = [1,2]
LITTLE = [0,3,4,5]
clusters = [BIG, LITTLE]

topology = Topology(clusters=clusters)</code></pre>
<p>
We can then check the behaviours of the task as follows:
</p>
<pre><code>s = SchedAssert(trace_file, topology, execname="cpuhog")</code></pre>
<p>Assert the switch of task between clusters</p>

<pre><code>s.assertSwitch("cluster",           # Topological Level
	       BIG,	            # From
	       LITTLE,              # To
	       window=(11.5, 12.5)  # Time Window
)</code></pre>

<p>Assert the duty cycle of the task in a window of time</p>

<pre>
<code>s.assertDutyCycle(10,		     # Expected Value of DutyCycle (%)
		 between_threshold,  # A boolean comparator function
		 window=(0, 1)      # Window of time
)</code>
</pre>

</p>
<p>A notebook explaining the usage of the framework for asserting the deadline scheduler behaviours can be seen <a href="https://rawgit.com/sinkap/0abbcc4918eb228b8887/raw/a1b4d6e0079f4ea0368d595d335bc340616501ff/SchedDeadline.html">here</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/ARM-software/bart">BART</a> is maintained by <a href="https://github.com/sinkap">KP Singh (sinkap)</a> and <a href="https://github.com/JaviMerino">Javi Merino</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>


  </body>
</html>
